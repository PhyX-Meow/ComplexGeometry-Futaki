% !TeX program = xelatex
\documentclass[12pt]{article}
\input{../preamble.tex}
\counterwithout{theorem}{section}
\counterwithout{equation}{section}

\begin{document}
Many sheaves are constructed from a \textbf{presheaf}. For actual purposes, it is
more convenient to start form presheaves.

\begin{definition}[Presheaf]
Let \(\mathcal{U}\) be the system of open sets of a topological space \(X\).
A correspondence from \(U\in \mathcal{U}\) to a set \(S(U)\) is called a
\textbf{presheaf} if 
\begin{enumerate}[(a)]
\item For \(U,V\in \mathcal{U}\) with \(V\subset U\), there is a map, called the
  restriction map \[
    \rho_V^U\colon S(U)\longrightarrow S(V)
  .\]
\item For \(U,V,W\in \mathcal{U}\) with \(W\subset V\subset U\), we have \[
  \rho_W^V\circ \rho_V^U=\rho_W^U
.\] 
\end{enumerate}
\end{definition}

Given a presheaf we can construct a sheaf \(S\) as follows: \[
  S=\bigcup_{x \in X}S_x,\quad S_x=\lim_{U\to x} S(U)
.\] Here \(\lim_{U\to x}S(U)\) means the set of equivalence classes of
\(\bigcup_{U\in \mathcal{U}_x}S(U)\) with equivalence relation \(\sim\) given by \[
  f\sim g\iff \exists\,W\in \mathcal{U}_x,W\subset U\cap V\text{ and }
  \rho_W^U(f)=\rho_W^V(g)
\] for \(f\in S(U)\), \(g\in S(V)\) and \(U,V\in \mathcal{U}_x\).

The topology of \(S\) is defined as generated by \[
  \{f_x:x\in U\},f\in S(U),U\in \mathcal{U}
.\] 

\begin{example}
  Let \(M\) be a complex manifold and \(D\) be a complex submanifold. Define \[
    I_D(U)=\{\text{holomorphic functions on }U\text{ vanishing along }D\}
  .\] Then \(\{I_D(U)\}\) is a presheaf, inducing the sheaf of germs of holomorphic
  functions vanishing along \(D\), or the ideal sheaf of \(D\), denoted by
  \(\mathcal{O}_D\).
\end{example}
\begin{remark}
  \(D\) can be chose singular and with multiplicity (non-reduced). You may examine
  yourself how to modify the definition.
\end{remark}

Now we study the \textbf{sheaf cohomology}, or cohomology with coefficients in
sheaves.

Let \(X\) be a paracompact Hausdorff topological space, \(S\) be a sheaf over \(X\).
Let \(\mathcal{U}=\{U_i\}\) be a locally finite open covering of \(X\). We first
define \(H^*(\mathcal{U},S)\).

\begin{definition}
  A \textbf{\(p\)-simplex} of \(\mathcal{U}\) is an ordered set of \(p+1\) open sets
  \(U_0,U_1,\ldots,U_p\in \mathcal{U}\) with \(U_0\cap \cdots \cap U_p\neq\emptyset\).
\end{definition}
\begin{definition}
  A \textbf{\(p\)-cochain} of \(\mathcal{U}\) with coefficients in \(S\) is an
  assignment for each \(p\)-simplex \(U_{i_0},\ldots,U_{i_p}\) a section \[
    c_{i_0,\ldots,i_p}\in \Gamma(U_{i_0}\cap \cdots U_{i_p},S)
  .\] We assume \(c_{i_0,\ldots,i_p}\) is alternating with respect to
  \(i_0,\ldots,i_p\). This cochain is denoted by \[
    c=\{c_{i_0,\ldots,i_p}\}
  .\] 
\end{definition}
\begin{definition}
  We denote the group of all \(p\)-cochains by \[
    C^p(\mathcal{U},S)
  .\] The \textbf{coboundary operator} \(\delta\colon C^p(\mathcal{U},S)\to C^{p+1}
  (\mathcal{U},S)\) is defined by \[
    (\delta c)_{i_0,\ldots,i_{p+1}}=
    \sum_{k=0}^{p+1}(-1)^k c_{i_0,\ldots,\widehat{i_k},\ldots,i_{p+1}}
  .\] Here the right hand side is considered on \(\bigcap_{k=0}^{p+1}U_{i_k}\).
\end{definition}

One can check easily \(\delta\circ \delta=0\).

\begin{definition}
  \[
    Z^p(\mathcal{U},S)=\{c\in C^p(\mathcal{U},S):\delta c=0\}
  \] is called the group of \textbf{cocycles} of dimension \(p\) or
  \textbf{\(p\)-cocycles}. \[
    H^p(\mathcal{U},S)=Z^{p}(\mathcal{U},S)/\delta C^{p-1}(\mathcal{U},S)
  \] is called the \textbf{\(p\)-th cohomology group} of \(\mathcal{U}\) with
  coefficients in \(S\).
\end{definition}

Let us compute \(H^0(\mathcal{U},S)=Z^0(\mathcal{U},S)\):

\(c=\{c_j\}\) is a cocycle if and only if \[
  (\delta c)_{ij}=c_j-c_i=0\quad \text{ on }U_i\cap U_j 
.\] This means \(c=\{c_j\}\) defines a global section on \(S\). Conversely, if
\(\sigma\in \Gamma(X,S)\) is a global section, then putting
\(\sigma_j=\sigma\big|_{U_j}\), \(\{\sigma_j\}\) defines a cocycle. Thus \[
  H^0(\mathcal{U},S)=\Gamma(X,S)
.\] Thus \(H^0(\mathcal{U},S)\) does not depend on the choice of \(\mathcal{U}\).
This justifies to define \[
  \boxed{H^0(X,S)=H^0(\mathcal{U},S)}.
\] For \(p\ge 1\), this is not true in general and we define \[
  H^p(X,S)=\lim_{\mathcal{U}} H^p(\mathcal{U},S)
.\] The limit on the right hand side is defined as follows:

We say that an open covering \(\mathcal{V}=\{V_j\}_{j\in J}\) is a refinement of
\(\mathcal{U}=\{U_i\}_{i\in I}\) if there exists \(\lambda\colon J\to I\), we have \[
  V_j\subset U_{\lambda_j}
.\] In this case we write \(\mathcal{U}<\mathcal{V}\), and fix one choice of
\(\lambda\colon J\to I\). Then we can induce a homomorphism \[
  \lambda_{\mathcal{V}}^{\mathcal{U}}\colon C^p(\mathcal{U},S)\longrightarrow
  C^p(\mathcal{V},S)
\] by putting \[
  (\lambda_{\mathcal{V}}^{\mathcal{U}}c)_{j_0,\ldots,j_p}
  =c_{\lambda(j_0),\ldots,\lambda(j_p)}
.\] This is a cochain map, \ie\ \[
  \lambda_{\mathcal{V}}^{\mathcal{U}}\circ \delta
  =\delta\circ \lambda_{\mathcal{V}}^{\mathcal{U}}
\] inducing \[
  \lambda_{\mathcal{V}}^{\mathcal{U}}\colon H^p(\mathcal{U},S)\longrightarrow
  H^p(\mathcal{V},S)
.\] 

\begin{lemma}
  The homomorphism \[
    \lambda_{\mathcal{V}}^{\mathcal{U}}\colon H^p(\mathcal{U},S)\longrightarrow
    H^p(\mathcal{V},S)
  \] does not depend on the choice of \(\lambda\).
\end{lemma}
\begin{proof}
  Choose another \(\mu\colon J\to I\) with \(V_j\subset U_{\mu(j)},\forall\,j\in J\).
  Define for \(c\in C^q(\mathcal{U},S)\), \[
    (\mathcal{k}c)_{j_1,\ldots,j_q}=\sum_{s=1}^{q}(-1)^{s-1}
    c_{\lambda(j_1),\ldots,\lambda(j_s),\mu(j_s),\ldots,\mu(j_q)}
  .\] One can check (exercise) \[
    \mu_{\mathcal{V}}^{\mathcal{U}}-\lambda_{\mathcal{V}}^{\mathcal{U}}
    =\delta\circ \mathcal{k}+\mathcal{k}\circ \delta
  .\] As \((\mathcal{k}c)_{j_1,\ldots,j_q}\) may not be alternating, we may replace
  it by its alternation, denoted by \(\mathcal{h}c\). This new 
  \(\mathcal{h}\colon C^p(\mathcal{U},S)\to C^{p-1}(\mathcal{V},S)\) also satisfy \[
    \mu_{\mathcal{V}}^{\mathcal{U}}-\lambda_{\mathcal{V}}^{\mathcal{U}}
    =\delta\circ \mathcal{h}+\mathcal{h}\circ \delta
  .\] (Such \(\mathcal{h}\) is called a \textbf{homotopy} between two cochain maps).

  Thus, for \(c\in Z^p(\mathcal{U},S)\), we have \[
    \mu_{\mathcal{V}}^{\mathcal{U}}c-\lambda_{\mathcal{V}}^{\mathcal{U}}c
    =\delta(\mathcal{h}c)
  .\] 
\end{proof}
Then the limit \(\lim_{\mathcal{U}}H^{p}(\mathcal{U},S)\) is defined as follows:

Consider an equivalence relation \(\sim\) in \(\bigcup_{\mathcal{U}}H^p(\mathcal{U},S)
\). For \([c]\in H^p(\mathcal{U},S)\) and \([c']\in H^p(\mathcal{V},S)\), we define
\([c]\sim[c']\) if there exists a common refinement \(\mathcal{W}\) of \(\mathcal{U}\)
and \(\mathcal{V}\) such that \[
  \lambda_{\mathcal{W}}^{\mathcal{U}}[c]=\lambda_{\mathcal{W}}^{\mathcal{V}}[c']
.\] Finally we define \[
  \lim_{\mathcal{U}}H^p(\mathcal{U},S)=\left(\bigcup_{\mathcal{U}}H^p(\mathcal{U},S)
  \right)\bigg/\sim,
\] the set of all equivalence classes of \(\sim\).

Let \(S\) and \(T\) be sheaves of modules, and \(h\colon S\to T\) be an homomorphism.
If \(\mathcal{U}\) is a locally finite open covering, \(h\) induces a homomorphism \[
  \mathcal{h}\colon C^p(\mathcal{U},S)\longrightarrow C^p(\mathcal{U},T)
.\] Since it satisfies \[
  \mathcal{h}\circ \delta=\delta\circ h,
\] it induces \[
  \mathcal{h}\colon H^p(\mathcal{U},S)\longrightarrow H^p(\mathcal{U},T)
.\] If \(\mathcal{V}\) is a refinement of \(\mathcal{U}\), we have a commutative
diagram
\[\begin{tikzcd}
	{H^p(\mathcal{U},S)} & {H^p(\mathcal{U},T)} \\
	{H^p(\mathcal{V},S)} & {H^p(\mathcal{V},T)}
	\arrow["{\mathcal{h}}", from=2-1, to=2-2]
	\arrow["{\mathcal{h}}", from=1-1, to=1-2]
	\arrow["{\lambda_{\mathcal{V}}^{\mathcal{U}}}", from=1-1, to=2-1]
	\arrow["{\lambda_{\mathcal{V}}^{\mathcal{U}}}", from=1-2, to=2-2]
\end{tikzcd}\]
Hence, by the definition of \(H^p(X,S)\), we obtain a homomorphism \[
  \mathcal{h}\colon H^p(X,S)\longrightarrow H^p(X,T)
.\] If we have a short exact sequence
\[\begin{tikzcd}
	0 & {S'} & S & {S''} & 0
	\arrow[from=1-1, to=1-2]
	\arrow["\iota", from=1-2, to=1-3]
	\arrow["\pi", from=1-3, to=1-4]
	\arrow[from=1-4, to=1-5]
\end{tikzcd}\]
We obtain the long exact sequence
\[\begin{tikzcd}[row sep=tiny]
	0 & {H^0(X,S')} & {H^0(X,S)} & {H^0(X,S'')} & {\phantom{0}} \\
	{\phantom{0}} & {H^1(X,S')} & {H^1(X,S)} & {H^1(X,S'')} & {\phantom{0}} \\
	{\phantom{0}} & {H^2(X,S')} & \cdots
	\arrow[from=1-1, to=1-2]
	\arrow["{\iota^*}", from=1-2, to=1-3]
	\arrow["{\pi^*}", from=1-3, to=1-4]
	\arrow["{\delta^*}", no head, from=1-4, to=1-5]
	\arrow["{\iota^*}", from=3-2, to=3-3]
	\arrow[from=3-1, to=3-2]
	\arrow[from=2-1, to=2-2]
	\arrow["{\iota^*}", from=2-2, to=2-3]
	\arrow["{\pi^*}", from=2-3, to=2-4]
	\arrow["{\delta^*}", no head, from=2-4, to=2-5]
\end{tikzcd}\]

\end{document}
